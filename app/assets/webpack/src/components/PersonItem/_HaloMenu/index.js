'use strict';

import React from 'react';
import uuid from 'uuid';
import Snap from 'snapsvg';

export default class _HaloMenuForPersonItem extends React.Component {
  constructor(props) {
    super(props);

    this.menuId = `menu_${uuid()}`;
    this.symbolsContainerId = `symbolsContainer_${uuid()}`;
    this.iconOneId = `iconOne_${uuid()}`;
    this.iconTwoId = `iconTwo_${uuid()}`;
    this.iconThreeId = `iconThree_${uuid()}`;
    this.itemsContainerId = `itemsContainer_${uuid()}`;
    this.itemOneId = `itemOne_${uuid()}`;
    this.itemTwoId = `itemTwo_${uuid()}`;
    this.itemThreeId = `itemThree_${uuid()}`;
    this.triggerId = `trigger_${uuid()}`;
  }

  componentDidMount() {
    const { menuId, itemsContainerId, triggerId, itemOneId, itemTwoId, itemThreeId } = this;
    const svg = document.getElementById(menuId);
    const itemsContainer = document.getElementById(itemsContainerId);
    const trigger = document.getElementById(triggerId);
    const label = trigger.querySelectorAll('text')[0];
    const items = Snap(itemsContainer);
    const originalTransform = itemsContainer.getAttribute('transform');
    let open = false;
    const { menuHandlers } = this.props;

    items.animate({ transform: 's0,0,250,250', opacity: 0 }, 0.005);
    svg.style.pointerEvents = 'none';

    trigger.addEventListener('click', e => {
      e.stopPropagation();
      open = !open;
      if (open) {
        items.animate({ transform: originalTransform, opacity: 1 }, 1000, mina.elastic);
        label.innerHTML = '-';
        svg.style.pointerEvents = 'auto';
      } else {
        items.animate({ transform: 's0,0,250,250', opacity: 0 }, 400, mina.backin);
        label.innerHTML = '+';
        svg.style.pointerEvents = 'none';
      }
    }, false);

    svg.onclick = e => e.stopPropagation();

    document.getElementById(itemOneId).onclick = menuHandlers[0];
    document.getElementById(itemTwoId).onclick = menuHandlers[1];
    document.getElementById(itemThreeId).onclick = menuHandlers[2];
  }

  render() {
    const { menuId, symbolsContainerId, iconOneId, iconTwoId, iconThreeId, itemsContainerId, itemOneId, itemTwoId, itemThreeId, triggerId } = this;
    const { menuHandlers, ...otherProps } = this.props;

    return (
      <div {...otherProps}>
        <svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" viewBox="-100 -100 700 350" id={menuId} style={{transformOrigin: '50% 50% 0px', transform: 'matrix3d(0.999989, 0.0047164, 0, 0, -0.0047164, 0.999989, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)', touchAction: 'none', userSelect: 'none'}}>
          <style>
            {`#menu{display:block;margin:0 auto;}a{cursor:pointer;outline:none;}.item .sector{transition:all .1s linear;fill:#fff;stroke:#111;}.item:hover .sector,.item:focus .sector{fill:#eee;}.menu-trigger{fill:#EA2A55;pointer-events:auto;}.menu-trigger:hover,.menu-trigger:focus{cursor:pointer;}symbol{overflow:visible;}`}
          </style>
          <g id={symbolsContainerId}>
            <symbol className="icon icon-" id={iconOneId} viewBox="0 0 40 40">
              <path d="M230.301,258.672c2.895,4.177,7.657,6.671,12.739,6.671h24.912c5.082,0,9.845-2.494,12.739-6.671   c2.895-4.177,3.559-9.512,1.774-14.271l-12.456-33.216c-2.292-6.109-7.988-10.057-14.513-10.057   c-6.525,0-12.222,3.948-14.513,10.057v0l-12.456,33.216C226.743,249.16,227.406,254.495,230.301,258.672z M242.572,249.667   l12.456-33.216c0.068-0.181,0.122-0.324,0.468-0.324s0.4,0.143,0.468,0.324l12.456,33.216c0.032,0.085,0.092,0.245-0.058,0.46   c-0.149,0.215-0.319,0.215-0.411,0.215h-24.912c-0.091,0-0.262,0-0.411-0.215C242.481,249.912,242.54,249.753,242.572,249.667z" fill="#444444"/>
              <path d="M183.497,225.343h5.333c8.491,0,16.907-2.806,23.7-7.9l17.067-12.8c5.886-4.414,9.4-11.442,9.4-18.8   c0-12.958-10.542-23.5-23.5-23.5h-24c-17.369,0-31.5,14.131-31.5,31.5v8C159.997,214.801,170.539,225.343,183.497,225.343z    M174.997,193.843c0-9.098,7.402-16.5,16.5-16.5h24c4.687,0,8.5,3.813,8.5,8.5c0,2.661-1.271,5.203-3.4,6.8l-17.067,12.8   c-4.213,3.16-9.434,4.9-14.7,4.9h-5.333c-4.687,0-8.5-3.813-8.5-8.5V193.843z" fill="#444444"/>
              <path d="M271.997,185.843c0,7.357,3.514,14.386,9.4,18.8l17.067,12.8c6.792,5.094,15.209,7.9,23.7,7.9h5.333   c12.958,0,23.5-10.542,23.5-23.5v-8c0-17.369-14.131-31.5-31.5-31.5h-24C282.539,162.343,271.997,172.885,271.997,185.843z    M295.497,177.343h24c9.098,0,16.5,7.402,16.5,16.5v8c0,4.687-3.813,8.5-8.5,8.5h-5.333c-5.266,0-10.487-1.74-14.7-4.9   l-17.067-12.8c-2.129-1.597-3.4-4.139-3.4-6.8C286.997,181.156,290.81,177.343,295.497,177.343z" fill="#444444"/>
              <path d="M497.707,404.81c-5.717-2.601-12.103-2.819-17.974-0.616l-22.675,8.492l-136.099-61.665l9.844-8.751   c0.552-0.074,1.104-0.204,1.647-0.408l124.022-46.68l22.024,10.02c5.712,2.603,12.097,2.824,17.979,0.621   c5.882-2.203,10.551-6.564,13.146-12.275c2.6-5.714,2.82-12.098,0.619-17.975c-2.201-5.877-6.561-10.546-12.274-13.146   l-9.505-4.325l4.326-9.505c5.366-11.793,0.137-25.754-11.651-31.118c-5.712-2.604-12.097-2.824-17.979-0.622   c-5.882,2.203-10.552,6.563-13.146,12.275l-10.028,22.038l-80.986,30.481v-26.904c18.863-6.517,32-24.509,32-44.905v-56   c0-74.715-60.785-135.5-135.5-135.5s-135.5,60.785-135.5,135.5v56c0,20.396,13.137,38.388,32,44.905v19.718l-78.12-35.396   l-8.489-22.658c-2.198-5.88-6.557-10.551-12.273-13.152s-12.102-2.821-17.975-0.616c-12.134,4.544-18.309,18.113-13.764,30.247   l3.663,9.78l-9.779,3.663C3.125,250.878-3.05,264.447,1.493,276.576c2.198,5.879,6.557,10.55,12.274,13.153   c5.717,2.602,12.103,2.82,17.975,0.615l22.674-8.492l118.295,53.598c0.968,0.967,1.96,1.914,2.988,2.828l12.557,11.162   L55.634,399.356l-22.024-10.02c-5.712-2.603-12.097-2.824-17.979-0.621c-5.882,2.203-10.551,6.564-13.145,12.274   c-5.367,11.793-0.139,25.754,11.655,31.121l9.505,4.325l-4.326,9.505c-2.6,5.714-2.82,12.098-0.619,17.975   c2.201,5.876,6.561,10.545,12.271,13.144c3.106,1.416,6.411,2.126,9.726,2.126c2.781,0,5.569-0.5,8.253-1.505   c5.881-2.203,10.551-6.563,13.146-12.275l10.03-22.039l162.386-61.118c0.05-0.019,0.097-0.044,0.146-0.064   c6.695,2.067,13.709,3.157,20.839,3.157c7.028,0,13.943-1.061,20.551-3.07l161.548,73.196l8.489,22.658   c2.198,5.88,6.557,10.551,12.274,13.152c3.106,1.414,6.41,2.124,9.722,2.124c2.783,0,5.571-0.501,8.253-1.508   c12.134-4.544,18.308-18.113,13.764-30.247l-3.663-9.78l9.779-3.663c12.134-4.544,18.308-18.113,13.766-30.242   C507.784,412.084,503.425,407.413,497.707,404.81z M448.167,264.118c1.857-0.699,3.362-2.106,4.185-3.913l11.314-24.864   c0.938-2.064,2.625-3.639,4.752-4.436c2.126-0.797,4.433-0.718,6.5,0.225c4.265,1.94,6.156,6.989,4.215,11.254l-7.432,16.332   c-1.715,3.77-0.05,8.217,3.72,9.933l16.332,7.432c2.067,0.94,3.645,2.629,4.44,4.753c0.795,2.125,0.716,4.434-0.227,6.505   c-0.938,2.064-2.625,3.64-4.752,4.436s-4.434,0.717-6.502-0.225l-24.863-11.311c-1.814-0.826-3.882-0.895-5.748-0.192   l-103.616,38.999c3.525-6.527,6.012-13.588,7.348-20.93L448.167,264.118z M134.997,209.843v-56c0-66.444,54.056-120.5,120.5-120.5   s120.5,54.056,120.5,120.5v56c0,15.191-10.649,28.426-25.403,31.71l-15.732,0.317c-17.019,0.344-30.865,14.472-30.865,31.494v8.479   c0,2.371-3.08,5.691-9,8.732v-0.732c0-4.142-3.358-7.5-7.5-7.5s-7.5,3.358-7.5,7.5v5.947c-4.945,1.125-10.622,1.958-17,2.331   v-8.278c0-4.142-3.358-7.5-7.5-7.5c-4.142,0-7.5,3.358-7.5,7.5v8.278c-6.378-0.373-12.055-1.206-17-2.331v-5.947   c0-4.142-3.358-7.5-7.5-7.5s-7.5,3.358-7.5,7.5v0.732c-5.92-3.042-9-6.361-9-8.732v-8.479c0-17.022-13.846-31.15-30.866-31.494   l-15.731-0.317C145.645,238.269,134.997,225.034,134.997,209.843z M57.783,266.91c-1.809-0.819-3.868-0.889-5.726-0.192   l-25.581,9.581c-2.124,0.797-4.432,0.717-6.497-0.223c-2.067-0.941-3.643-2.628-4.438-4.756c-0.796-2.127-0.718-4.437,0.222-6.501   c0.94-2.065,2.629-3.641,4.756-4.438l16.803-6.293c1.863-0.697,3.372-2.106,4.196-3.917c0.824-1.811,0.895-3.874,0.197-5.737   l-6.293-16.803c-1.644-4.388,0.59-9.296,4.982-10.941c2.123-0.797,4.43-0.717,6.497,0.224c2.066,0.94,3.642,2.628,4.438,4.757   l9.583,25.579c0.699,1.866,2.113,3.377,3.928,4.2l87.39,39.595c0.57,7.223,2.241,14.263,4.919,20.892L57.783,266.91z    M63.942,430.42c-1.857,0.699-3.362,2.106-4.184,3.913l-11.315,24.864c-0.938,2.064-2.625,3.64-4.752,4.437   c-2.126,0.796-4.434,0.717-6.501-0.225c-2.068-0.94-3.645-2.629-4.44-4.753c-0.796-2.125-0.716-4.434,0.225-6.501l7.432-16.332   c1.715-3.77,0.05-8.217-3.72-9.933l-16.332-7.431c-4.265-1.941-6.156-6.99-4.213-11.26c0.938-2.064,2.625-3.639,4.751-4.436   c2.126-0.796,4.433-0.717,6.502,0.225l24.863,11.311c1.814,0.826,3.882,0.895,5.748,0.193L200.922,360.7l7.655,6.805   c2.335,2.076,4.796,3.977,7.356,5.71L63.942,430.42z M255.495,370.343c-13.637,0-26.76-4.989-36.952-14.049l-32.878-29.226   c-0.906-0.806-1.772-1.647-2.619-2.504c-0.282-0.352-0.594-0.682-0.941-0.982c-9.646-10.265-15.108-23.88-15.108-38.084V256.69   l8.832,0.178c8.915,0.18,16.168,7.58,16.168,16.497v8.479c0,9.6,7.439,18.075,20.948,23.864   c11.489,4.924,26.602,7.636,42.552,7.636s31.063-2.712,42.552-7.636c13.508-5.79,20.948-14.265,20.948-23.864v-8.479   c0-8.917,7.253-16.317,16.167-16.497l8.833-0.178v28.808c0,15.873-6.804,31.024-18.668,41.57l-32.878,29.226   C282.258,365.354,269.135,370.343,255.495,370.343z M490.955,434.159l-16.803,6.293c-3.879,1.453-5.845,5.775-4.393,9.654   l6.293,16.803c1.644,4.388-0.589,9.295-4.982,10.94c-2.124,0.797-4.431,0.717-6.497-0.223c-2.067-0.94-3.643-2.628-4.438-4.757   l-9.583-25.579c-0.699-1.866-2.113-3.377-3.928-4.2l-152.65-69.164c2.951-1.919,5.779-4.054,8.442-6.422l6.272-5.575l145.003,65.7   c1.809,0.819,3.868,0.888,5.726,0.192l25.582-9.581c2.121-0.797,4.429-0.718,6.496,0.223c2.067,0.941,3.643,2.628,4.438,4.756   C497.576,427.608,495.343,432.515,490.955,434.159z" fill="#444444"/>
              <path d="M305.731,81.02c17.652,12.218,30.273,30.32,35.537,50.973c0.865,3.393,3.915,5.649,7.262,5.649   c0.613,0,1.236-0.076,1.858-0.234c4.014-1.023,6.438-5.106,5.415-9.12c-6.157-24.158-20.909-45.325-41.536-59.602   c-3.407-2.358-8.078-1.508-10.435,1.899C301.475,73.991,302.325,78.662,305.731,81.02z" fill="#444444"/>
              <path d="M270.806,66.668c3.222,0.564,6.45,1.318,9.593,2.241c0.705,0.207,1.417,0.306,2.116,0.306c3.243,0,6.233-2.12,7.193-5.389   c1.167-3.974-1.109-8.142-5.083-9.309c-3.68-1.081-7.459-1.963-11.233-2.624c-4.083-0.715-7.967,2.015-8.681,6.095   C263.998,62.068,266.726,65.954,270.806,66.668z" fill="#444444"/>
            </symbol>
            <symbol className="icon icon-" id={iconTwoId} viewBox="0 0 40 40">
              <g>
                <path d="M640.35,91.169H536.971V23.991C536.971,10.469,526.064,0,512.543,0c-1.312,0-2.187,0.438-2.614,0.875
                  C509.491,0.438,508.616,0,508.179,0H265.212h-1.74h-1.75c-13.521,0-23.99,10.469-23.99,23.991v67.179H133.916
                  c-29.667,0-52.783,23.116-52.783,52.783v38.387v47.981h45.803v491.6c0,29.668,22.679,52.346,52.346,52.346h415.703
                  c29.667,0,52.782-22.678,52.782-52.346v-491.6h45.366v-47.981v-38.387C693.133,114.286,670.008,91.169,640.35,91.169z
                   M285.713,47.981h202.84v43.188h-202.84V47.981z M599.349,721.922c0,3.061-1.312,4.363-4.364,4.363H179.282
                  c-3.052,0-4.364-1.303-4.364-4.363V230.32h424.431V721.922z M644.715,182.339H129.551v-38.387c0-3.053,1.312-4.802,4.364-4.802
                  H640.35c3.053,0,4.365,1.749,4.365,4.802V182.339z" />
                <rect x="475.031" y="286.593" width="48.418" height="396.942" />
                <rect x="363.361" y="286.593" width="48.418" height="396.942" />
                <rect x="251.69" y="286.593" width="48.418" height="396.942" />
              </g>
            </symbol>
            <symbol className="icon icon-" id={iconThreeId} viewBox="0 0 40 40">
              <g>
                <path d="M149.996,0C67.157,0,0.001,67.161,0.001,149.997S67.157,300,149.996,300s150.003-67.163,150.003-150.003    S232.835,0,149.996,0z M221.302,107.945l-14.247,14.247l-29.001-28.999l-11.002,11.002l29.001,29.001l-71.132,71.126    l-28.999-28.996L84.92,186.328l28.999,28.999l-7.088,7.088l-0.135-0.135c-0.786,1.294-2.064,2.238-3.582,2.575l-27.043,6.03    c-0.405,0.091-0.817,0.135-1.224,0.135c-1.476,0-2.91-0.581-3.973-1.647c-1.364-1.359-1.932-3.322-1.512-5.203l6.027-27.035    c0.34-1.517,1.286-2.798,2.578-3.582l-0.137-0.137L192.3,78.941c1.678-1.675,4.404-1.675,6.082,0.005l22.922,22.917    C222.982,103.541,222.982,106.267,221.302,107.945z" fill="#444444" />
              </g>
            </symbol>
          </g>
          <g id={itemsContainerId}>
            <a className="item" id={itemOneId} role="link" tabIndex="0" xlinkHref="" xlinkTitle=" " transform="matrix(1,0,0,1,0,0)" data-svg-origin="250 250">
              <path fill="none" stroke="#111" d="M330,250 l170,0 A250,250 0 0,0 375,33.49364905389035 l-85,147.22431864335456 A80,80 0 0,1 330,250" className="sector"></path>
              <use xlinkHref={`#${iconOneId}`} width="8" height="8" x="339.2602233886719" y="122.5" transform="rotate(0 393.7602233886719 167)"></use>
            </a>
            <a className="item" id={itemTwoId} role="link" tabIndex="0" xlinkHref="" xlinkTitle=" " transform="matrix(0.5,-0.86602,0.86602,0.5,-91.5063509461097,341.5063509461096)" data-svg-origin="250 250">
              <path fill="none" stroke="#111" d="M330,250 l170,0 A250,250 0 0,0 375,33.49364905389035 l-85,147.22431864335456 A80,80 0 0,1 330,250" className="sector"></path>
              <use xlinkHref={`#${iconTwoId}`} width="5" height="5" x="345.2602233886719" y="122.5" transform="rotate(60 393.7602233886719 167)"></use>
            </a>
            <a className="item" id={itemThreeId} role="link" tabIndex="0" xlinkHref="" xlinkTitle=" " transform="matrix(-0.49999,-0.86602,0.86602,-0.49999,158.49364905389027,591.5063509461096)" data-svg-origin="250 250">
              <path fill="none" stroke="#111" d="M330,250 l170,0 A250,250 0 0,0 375,33.49364905389035 l-85,147.22431864335456 A80,80 0 0,1 330,250" className="sector"></path>
              <use xlinkHref={`#${iconThreeId}`} width="13" height="13" x="347.2602233886719" y="122.5" transform="rotate(110 393.7602233886719 167)"></use>
            </a>
          </g>
          <g id={triggerId} className="trigger menu-trigger" role="button">
            <circle cx="250" cy="250" r="60"></circle>
            <text textAnchor="middle" x="250" y="247" fill="#fff" fontSize="5em">+</text>
          </g>
        </svg>
      </div>
    );
  }
}
